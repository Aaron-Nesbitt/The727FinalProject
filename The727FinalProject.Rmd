---
title: "The727FinalProject"
author: "Aaron Nesbitt and Jessica Valencia"
date: '2022-12-01'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(dplyr)
library(rtweet)
library(ggplot2)
library(plyr)
library(tidyverse)
library(tidytext)
library(ggmap)
```

We search we original tweets, allowing for up to 18 thousand. We ran the function at 5 pm on Tuesday November 29th.

```{r}
```

```{r eval=FALSE, include=FALSE}
musk <- search_tweets(
  q = "musk Twitter, lang:en",
  n = 18000,
  include_rts = FALSE
)
```

```{r}
head(musktweetsfinal$text, n=10)
```

```{r}
colnames(musktweetsfinal)
```

```{r}
library(quanteda)

opinionWords = c('Apple')

muskTweets = data.frame()
doNotNeed = data.frame()

for(i in 1:nrow(musktweetsfinal)){
  # break up tweet into individual words
  tweet = musktweetsfinal$text[i]
  tweet = tolower(tweet)
  words = tokens(tweet)
  # if it contains an irrelevant word, put it in the irrelevant data frame
  if(length(intersect(words[['text1']], opinionWords))>0){
    doNotNeed = rbind(doNotNeed, musktweetsfinal[i,])
  }
  else{
    muskTweets = rbind(muskTweets, musktweetsfinal[i,])
  }
}
```

```{r, eval =FALSE}
opinionWords = c('covid')

muskTweets2 = data.frame()
doNotNeed2 = data.frame()

for(i in 1:nrow(muskTweets)){
  # break up tweet into individual words
  tweet = muskTweets$text[i]
  tweet = tolower(tweet)
  words = tokens(tweet)
  # if it contains an irrelevant word, put it in the irrelevant data frame
  if(length(intersect(words[['text1']], opinionWords))>0){
    doNotNeed2 = rbind(doNotNeed, musktweetsfinal[i,])
  }
  else{
    muskTweets2 = rbind(muskTweets, musktweetsfinal[i,])
  }
}
```

```{R, eval=FALSE}
muskTweets3 = data.frame()
doNotNeed3 = data.frame()

for(i in 1:nrow(muskTweets2)){
  # break up tweet into individual words
  tweet = muskTweets2$text[i]
  tweet = tolower(tweet)
  words = tokens(tweet)
  # if it contains an irrelevant word, put it in the irrelevant data frame
  if(length(intersect(words[['text1']], opinionWords))>0){
    doNotNeed3 = rbind(doNotNeed, musktweetsfinal[i,])
  }
  else{
    muskTweets3 = rbind(muskTweets2, musktweetsfinal[i,])
  }
}

```


This is a sentiment analysis of the tweets. 
```{r, eval=FALSE}
#install.packages("SentimentAnalysis")
library(SentimentAnalysis)
sentiments = analyzeSentiment(iconv(as.character(musktweetsfinal$text), to='UTF-8'))
head(sentiments)
```


